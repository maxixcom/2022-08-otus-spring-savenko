# Домашнее задание к занятию #11 - JPQL, Spring ORM, DAO на основе Spring ORM + JPA

## Задача

Переписать приложение для хранения книг на ORM

**Цель**: полноценно работать с JPA + Hibernate для подключения к реляционным БД посредством ORM-фреймворка
**Результат**: Высокоуровневое приложение с JPA-маппингом сущностей

**Описание/Пошаговая инструкция выполнения домашнего задания:**

Домашнее задание выполняется переписыванием предыдущего на JPA.

1. Использовать JPA, Hibernate только в качестве JPA-провайдера.
2. Для решения проблемы N+1 можно использовать специфические для Hibernate аннотации @Fetch и @BatchSize.
3. Добавить сущность "комментария к книге", реализовать CRUD для новой сущности.
4. Покрыть репозитории тестами, используя H2 базу данных и соответствующий H2 Hibernate-диалект для тестов.
5. Не забудьте отключить DDL через Hibernate
6. @Transactional рекомендуется ставить только на методы сервиса.

Это домашнее задание будет использоваться в качестве основы для других ДЗ
Данная работа не засчитывает предыдущую!

## Требования для сборки и выполнения

- Java 11 (JDK)

## Сборка

```shell
./gradlew build
```

## Запуск

```shell
java -jar ./build/libs/booklib-0.0.1-SNAPSHOT.jar
```

## Сборка дистрибутива

```shell
./gradlew installBootDist
```

Дистрибутив вы сможете найти в папке `build/install/booklib-boot`.

Скрипт запуска находится в папке bin дистрибутива: `build/install/booklib-boot/bin/`

Получить заархивированную версию дистрибутива можно одной из следующих команд:

```shell
./gradlew distTar
```

или

```shell
./gradlew distZip
```

## Доступные операции

После запуска, приложение перейдет в интерактивный режим и появится приглашение `shell:>`. 
Получить список доступных команд можно следующим образом:

```
shell:> help
```

**Команды управления библиотекой книг:**

| Команда                                   | Описание            |
|-------------------------------------------|---------------------|
| `n`, `create-book`                        | Создать книгу       |
| `d`, `del`, `delete-books`                | Удалить книгу       |
| `u`, `e`, `update`, `edit`, `update-book` | Редактировать книгу |
| `l`, `p`, `list`, `list-books`            | Вывести список книг |


**Управление комментариями к книгам:**

| Команда                         | Описание                     |
|---------------------------------|------------------------------|
| `nc`, `comment-book`            | Добавить комментарий к книге |
| `lc`, `pc`, `list-book-comment` | Список комментариев к книги  |
| `uc`, `ec`, `update-comment`    | Редактировать комментарий    |
| `dc`, `delete-comment`          | Удалить комментарий          |
